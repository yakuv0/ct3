# vim: syntax=config

player-operation-mode=pseudo-gui
log-file=~/Library/Logs/ct3.log
input-gamepad=yes
window-maximized=yes
ontop=yes
ontop-level=window
geometry=50%:0%
autofit-larger=80%x100%
autofit-smaller=50%x100%
hidpi-window-scale=no     ##fixes mouse dissapears after exiting full screen

###########
# General #
###########
input-ipc-server=/tmp/mpvsocket         # listen for IPC on this socket
load-stats-overlay=no                   # use local stats.lua
#save-position-on-quit                  # handled by a script

no-border                               # no window title bar
msg-module                              # prepend module name to log messages
msg-color                               # color log messages on terminal
term-osd-bar                            # display a progress bar on the terminal
#use-filedir-conf                        # look for additional config files in the directory of the opened file
pause                                   # no autoplay
keep-open                               # keep the player open when a file's end is reached
#autofit-larger=66%                # resize window in case it's larger than W%xH% of the screen
#cursor-autohide-fs-only                 # don't autohide the cursor in window mode, only fullscreen
force-window=yes
input-media-keys=yes                     # enable/disable OSX media keys
cursor-autohide=1000                    # autohide the curser after 1s
prefetch-playlist=yes
force-seekable=yes

screenshot-format=png
screenshot-png-compression=0
screenshot-directory='~~/ct3/img'

#hls-bitrate=max                         # use max quality for HLS streams

[default]
#########
# Cache #
#########

# Configure the cache to be really big (multiple GBs)
# We have a lot of memory, so why not use it for something

cache=yes
demuxer-max-bytes=1000000KiB            # ~1000 MiB in bytes
demuxer-max-back-bytes=250000000        # ByteSize (0 to 2147483647)

#############
# OSD / OSC #
#############
osd-fractions=yes
#osd-level=1                             # enable osd and display --osd-status-msg on interaction
osd-duration=2500                       # hide the osd after x ms
osd-status-msg='${time-pos} / ${duration}${?percent-pos:　(${percent-pos}%)}${?frame-drop-count:${!frame-drop-count==0:　Dropped: ${frame-drop-count}}}\n${?chapter:Chapter: ${chapter}}'
osd-msg3='${estimated-frame-number} / ${estimated-frame-count}' 
osd-font='unifont'
osd-font-size=26
osd-spacing=1
#osd-shadow-color='#000000'
#osd-shadow-offset=1                    # pixel width for osd text and progress bar
osd-back-color='#000000'
osd-color='#ffffff'                   # ARGB format
osd-border-color='#000000'            # ARGB format
#osd-bar-align-y=1                       # progress bar y alignment (-1 top, 0 centered, 1 bottom)
osd-border-size=2                     # size for osd text and progress bar
#osd-bar-h=2                             # height of osd bar as a fractional percentage of your screen height
#osd-bar-w=80                            # width of " " "
osd-align-y=bottom
no-osd-bar
#script-opts=osc-layout=topbar,osc-seekbarstyle=none,osc-hidetimeout=1500,osc-fadeduration=200,osc-timems=yes,osc-scalewindowed=1,osc-scalefullscreen=0.65
#############
# Subtitles #
#############

sub-auto=fuzzy                          # external subs don't have to match the file name exactly to autoload
sub-file-paths-append=ass               # search for external subs in these relative subdirectories
sub-file-paths-append=srt
sub-file-paths-append=sub
sub-file-paths-append=subs
sub-file-paths-append=subtitles

demuxer-mkv-subtitle-preroll            # try to correctly show embedded subs when seeking
embeddedfonts=yes                       # use embedded fonts for SSA/ASS subs
sub-fix-timing=no                       # do not try to fix gaps (which might make it worse in some cases)
sub-ass-force-style=Kerning=yes         # allows you to override style parameters of ASS scripts
sub-use-margins
sub-ass-force-margins

# the following options only apply to subtitles without own styling (i.e. not ASS but e.g. SRT)
sub-font="Source Sans Pro Semibold"
sub-font-size=36
sub-color="#FFFFFFFF"
sub-border-color="#FF262626"
sub-border-size=1.2
sub-shadow-offset=1
sub-shadow-color="#33000000"
sub-spacing=0.5


#############
# Languages #
#############

slang=enm,en,eng,de,deu,ger             # automatically select these subtitles (decreasing priority)
alang=ja,jp,jpn,en,eng,de,deu,ger       # automatically select these audio tracks (decreasing priority)


#########
# Audio #
#########

audio-file-auto=no                   # Don't automatically load external audio files (default)
audio-pitch-correction=no              # automatically insert scaletempo when playing with higher speed
volume-max=200                          # maximum volume in %, everything above 100 results in amplification
volume=0                              # default volume, 100 = unchanged


################
# Video Output #
################

# Active VO options are set conditionally and require my slightly modified 
# `scripts/auto-profiles.lua` as well as `scripts/auto-profiles-functions.lua`. 
# More information about auto-profiles in general: https://github.com/wiiaboo/mpv-scripts/blob/master/auto-profiles.lua
# on_battery() and dedicated_gpu() are my own functions in `scripts/auto-profiles-functions.lua`
# and might need to be adjusted for your system/setup.

# Defaults for all profiles
tscale=oversample                      # [sharp] oversample <-> linear (triangle) <-> catmull_rom <-> mitchell <-> gaussian <-> bicubic [smooth]
opengl-early-flush=no
opengl-pbo=yes                         # "yes" is currently bugged: https://github.com/mpv-player/mpv/issues/4988
icc-profile-auto
#icc-contrast=1000                      # silence some warning because the profile is bad
#icc-force-contrast=1000
video-scale-x=0.85
video-scale-y=0.85
#hwdec=videotoolbox


###################################
# Protocol Specific Configuration #
###################################

[protocol.https]
cache=yes
user-agent='Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:57.0) Gecko/20100101 Firefox/58.0'

[protocol.http]
cache=yes
user-agent='Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:57.0) Gecko/20100101 Firefox/58.0'

#mpv < 35
#[aud]
#profile-desc=cond:(string.match(get("filename", ""), ".mp3") or string.match(get("filename", ""), ".flac")) ~= nil
#script-opts=visualizer-quality=low
#no-audio-display
#ontop=yes
#ontop-level=window
#geometry=30%+100%+0%
#volume=100
#[ep]
#profile-desc=cond:(string.match(get("filename", ""), ".mp4") or string.match(get("filename", ""), ".mkv")) ~= nil
#osd-playing-msg = 'AutoProfile: EP: ${media-title}'
#volume=0
#ontop=yes
#ontop-level=window
#geometry=50%+100%+0%
#autofit-larger=80%
#autofit-smaller=50%

# [aud]
# profile-cond = (filename:match"%.mp3$" or filename:match"%.flac$") ~= nil
# script-opts=visualizer-mode=novideo
# script-opts=visualizer-quality=low
# no-audio-display
# ontop=yes
# ontop-level=window
# geometry=540x300

# [ep]
# profile-cond = (filename:lower():match"s%d+e%d+" or filename:match"%.mkv$" or filename:match"%.mp4$" or filename:lower():match"ep%d+") ~= nil
# osd-playing-msg = 'EP: ${media-title}'
# volume=100
# ontop=yes
# ontop-level=window
# geometry=50%+100%+100%
# autofit-larger=80%
# autofit-smaller=50%